(this["webpackJsonpkapusta-bl3-front"]=this["webpackJsonpkapusta-bl3-front"]||[]).push([[4],{11:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return j})),n.d(t,"a",(function(){return l}));var r=n(24),c=n(16),a=n.n(c),u=n(1),o=n(25),i="https://connections-api.herokuapp.com",s=Object(u.c)("auth/register",function(){var e=Object(r.a)(a.a.mark((function e(t,n){var r,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,fetch("".concat(i,"/users/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:return c=e.sent,e.next=7,c.json();case 7:return u=e.sent,Object(o.b)("Congratulations, you are registered!"),e.abrupt("return",u);case 12:e.prev=12,e.t0=e.catch(1),r({error:e.t0.message});case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()),b=Object(u.c)("auth/login",function(){var e=Object(r.a)(a.a.mark((function e(t,n){var r,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,fetch("".concat(i,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:return c=e.sent,e.next=7,c.json();case 7:return u=e.sent,e.abrupt("return",u);case 11:e.prev=11,e.t0=e.catch(1),r({error:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}()),j=Object(u.c)("auth/logout",function(){var e=Object(r.a)(a.a.mark((function e(t,n){var r,c,u,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,c=n.getState,u=c(),o=u.auth.token){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,fetch("".concat(i,"/users/logout"),{method:"POST",headers:{Authorization:"Bearer ".concat(o)}});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),r(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t,n){return e.apply(this,arguments)}}()),l=Object(u.c)("auth/currentUser",function(){var e=Object(r.a)(a.a.mark((function e(t,n){var r,c,u,o,s,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.rejectWithValue,c=n.getState,u=c(),o=u.auth.token){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,fetch("".concat(i,"/users/current"),{headers:{Authorization:"Bearer ".concat(o)}});case 8:return s=e.sent,e.next=11,s.json();case 11:return b=e.sent,e.abrupt("return",b);case 15:e.prev=15,e.t0=e.catch(5),r(e.t0.message);case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,n){return e.apply(this,arguments)}}())},17:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u}));var r=function(e){return e.auth.isAuth},c=function(e){return e.auth.user.name},a=function(e){return e.auth.isFetchingCurrentUser},u=function(e){return e.auth.token}},39:function(e,t,n){},41:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(19),u=n.n(a),o=(n(39),n(40),n(41),n(27)),i=n.n(o),s=n(2),b=n(3);function j(e){var t=e.isAuth,n=e.component;return Object(b.jsx)(b.Fragment,{children:t?Object(b.jsx)(n,{}):Object(b.jsx)(s.a,{to:"/"})})}var l=n(17),d=n(6);function h(e){var t=e.component,n=Object(d.e)(l.a);return Object(b.jsx)(b.Fragment,{children:n?Object(b.jsx)(s.a,{to:"/main"}):Object(b.jsx)(t,{})})}var O=n(11),p=n(25),f=(n(67),Object(r.lazy)((function(){return n.e(1).then(n.bind(null,76))}))),g=Object(r.lazy)((function(){return n.e(2).then(n.bind(null,72))})),m=Object(r.lazy)((function(){return n.e(5).then(n.bind(null,73))})),x=Object(r.lazy)((function(){return n.e(0).then(n.bind(null,74))})),y=Object(r.lazy)((function(){return n.e(3).then(n.bind(null,75))}));var v,k,C=function(){var e=Object(d.d)(),t=Object(d.e)(l.a),n=Object(d.e)(l.c),c=Object(d.e)(l.b);return Object(r.useEffect)((function(){n&&e(Object(O.a)())}),[e]),Object(b.jsxs)("div",{className:"app",children:[Object(b.jsx)("p",{children:"\u0412\u041f\u0415\u0420\u0415\u0414!"}),Object(b.jsxs)(r.Suspense,{fallback:Object(b.jsx)(i.a,{type:"ThreeDots",color:"orange",height:80,width:80}),children:[Object(b.jsx)(f,{isAuth:t}),c?Object(b.jsx)(i.a,{type:"ThreeDots",color:"orange",height:80,width:80}):Object(b.jsxs)(s.d,{children:[Object(b.jsx)(s.b,{path:"/",element:Object(b.jsx)(h,{isAuth:t,component:g})}),Object(b.jsx)(s.b,{path:"/register",element:Object(b.jsx)(h,{isAuth:t,component:m})}),Object(b.jsx)(s.b,{path:"/main",element:Object(b.jsx)(j,{isAuth:t,component:x})}),Object(b.jsx)(s.b,{path:"/statistics",element:Object(b.jsx)(j,{isAuth:t,component:y})})]})]}),Object(b.jsx)(p.a,{autoClose:3e3})]})},A=n(32),w=n(7),L=n(34),T=n(9),S=n(1),F=Object(S.b)("filter/set"),z=Object(S.d)("",Object(w.a)({},F,(function(e,t){return t.payload}))),P=Object(T.b)({filter:z}),U=n(15),E=n(29),q=n.n(E),D=n(33),J=n(13),V=Object(D.a)({reducerPath:"phonebookApi",baseQuery:Object(J.d)({baseUrl:"https://619d65ca131c600017088eee.mockapi.io/api/v1"}),tagTypes:["Contact"],endpoints:function(e){return{fetchPhonebook:e.query({query:function(){return"/contacts"},providesTags:["Contact"]}),addContact:e.mutation({query:function(e){return{url:"/contacts",method:"POST",body:e}},invalidatesTags:["Contact"]}),deleteContact:e.mutation({query:function(e){return{url:"/contacts/".concat(e),method:"DELETE"}},invalidatesTags:["Contact"]})}}}),W=(V.useFetchPhonebookQuery,V.useDeleteContactMutation,V.useAddContactMutation,n(5)),B=Object(S.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isFetchingCurrentUser:!1,error:null,isLoading:!1,isAuth:!1},extraReducers:(v={},Object(w.a)(v,O.d.pending,(function(e,t){return Object(W.a)(Object(W.a)({},e),{},{isLoading:!0})})),Object(w.a)(v,O.d.fulfilled,(function(e,t){return Object(W.a)(Object(W.a)({},e),{},{user:t.payload.user,token:t.payload.token,isFetchingCurrentUser:!1,isAuth:!0,isLoading:!1})})),Object(w.a)(v,O.d.rejected,(function(e,t){return Object(W.a)(Object(W.a)({},e),{},{isLoading:!1,error:t.payload})})),Object(w.a)(v,O.b.pending,(function(e){return Object(W.a)(Object(W.a)({},e),{},{isLoading:!0})})),Object(w.a)(v,O.b.fulfilled,(function(e,t){return Object(W.a)(Object(W.a)({},e),{},{user:t.payload.user,token:t.payload.token,isAuth:!0,isLoading:!1})})),Object(w.a)(v,O.b.rejected,(function(e,t){return Object(W.a)(Object(W.a)({},e),{},{isLoading:!1,error:t.payload})})),Object(w.a)(v,O.c.pending,(function(e){return Object(W.a)(Object(W.a)({},e),{},{isLoading:!0})})),Object(w.a)(v,O.c.fulfilled,(function(e){return Object(W.a)(Object(W.a)({},e),{},{user:{name:null,email:null},token:null,isLoading:!1,isAuth:!1})})),Object(w.a)(v,O.c.rejected,(function(e,t){return Object(W.a)(Object(W.a)({},e),{},{isLoading:!1,error:t.payload})})),Object(w.a)(v,O.a.pending,(function(e){return Object(W.a)(Object(W.a)({},e),{},{isLoading:!0,isFetchingCurrentUser:!0})})),Object(w.a)(v,O.a.fulfilled,(function(e,t){return Object(W.a)(Object(W.a)({},e),{},{user:t.payload,isFetchingCurrentUser:!1,isLoading:!1,isAuth:!0})})),Object(w.a)(v,O.a.rejected,(function(e,t){return Object(W.a)(Object(W.a)({},e),{},{isLoading:!1,error:t.payload,isFetchingCurrentUser:!1,isAuth:!1})})),v)}).reducer,M={key:"phonebook",storage:q.a,whitelist:[],blacklist:["filter"]},N={key:"authToken",storage:q.a,whitelist:["token"]},Q=Object(U.g)(N,B),I=[].concat(Object(L.a)(Object(S.f)({serializableCheck:{ignoredActions:[U.a,U.f,U.b,U.c,U.d,U.e]}})),[V.middleware]),R=Object(S.a)({reducer:(k={contacts:Object(U.g)(M,P)},Object(w.a)(k,V.reducerPath,V.reducer),Object(w.a)(k,"auth",Q),k),middleware:I}),G={store:R,persistor:Object(U.h)(R)},H=n(22);u.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(d.a,{store:G.store,children:Object(b.jsx)(A.a,{loading:"",persistor:G.persistor,children:Object(b.jsx)(H.a,{children:Object(b.jsx)(C,{})})})})}),document.getElementById("root"))}},[[70,6,7]]]);
//# sourceMappingURL=main.c3614113.chunk.js.map